{"version":"1.124.1","results":[{"check_id":"yaml.docker-compose.security.no-new-privileges.no-new-privileges","path":"/tmp/repo-scans/scan-6/docker/docker-compose.yml","start":{"line":3,"col":5,"offset":29},"end":{"line":3,"col":12,"offset":36},"extra":{"message":"Service 'mongodb' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges","shortlink":"https://sg.run/0n8q"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","path":"/tmp/repo-scans/scan-6/docker/docker-compose.yml","start":{"line":3,"col":5,"offset":29},"end":{"line":3,"col":12,"offset":36},"extra":{"message":"Service 'mongodb' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir","https://blog.atomist.com/security-of-docker-kubernetes/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","shortlink":"https://sg.run/e4JE"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":["PartialParsing",[{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":47,"col":40,"offset":1173},"end":{"line":47,"col":60,"offset":1193}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":48,"col":24,"offset":1173},"end":{"line":48,"col":48,"offset":1197}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":49,"col":20,"offset":1173},"end":{"line":49,"col":40,"offset":1193}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":50,"col":20,"offset":1173},"end":{"line":50,"col":40,"offset":1193}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":51,"col":20,"offset":1173},"end":{"line":51,"col":40,"offset":1193}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":52,"col":20,"offset":1173},"end":{"line":52,"col":40,"offset":1193}},{"path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":53,"col":24,"offset":1173},"end":{"line":53,"col":48,"offset":1197}}]],"message":"Syntax error at line /tmp/repo-scans/scan-6/.github/workflows/ci.yml:47:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ secrets.JWT_SECRET` was unexpected","path":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","spans":[{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":47,"col":40,"offset":1173},"end":{"line":47,"col":60,"offset":1193}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":48,"col":24,"offset":1173},"end":{"line":48,"col":48,"offset":1197}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":49,"col":20,"offset":1173},"end":{"line":49,"col":40,"offset":1193}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":50,"col":20,"offset":1173},"end":{"line":50,"col":40,"offset":1193}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":51,"col":20,"offset":1173},"end":{"line":51,"col":40,"offset":1193}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":52,"col":20,"offset":1173},"end":{"line":52,"col":40,"offset":1193}},{"file":"/tmp/repo-scans/scan-6/.github/workflows/ci.yml","start":{"line":53,"col":24,"offset":1173},"end":{"line":53,"col":48,"offset":1197}}]}],"paths":{"scanned":["/tmp/repo-scans/scan-6/.dockerignore","/tmp/repo-scans/scan-6/.github/workflows/ci.yml","/tmp/repo-scans/scan-6/.gitignore","/tmp/repo-scans/scan-6/.husky/commit-msg","/tmp/repo-scans/scan-6/.husky/pre-commit","/tmp/repo-scans/scan-6/.prettierrc","/tmp/repo-scans/scan-6/LICENSE","/tmp/repo-scans/scan-6/Readme.md","/tmp/repo-scans/scan-6/commitlint.config.js","/tmp/repo-scans/scan-6/docker/.gitkeep","/tmp/repo-scans/scan-6/docker/docker-compose.yml","/tmp/repo-scans/scan-6/eslint.config.mjs","/tmp/repo-scans/scan-6/jest.config.js","/tmp/repo-scans/scan-6/k8s/.gitkeep","/tmp/repo-scans/scan-6/nodemon.json","/tmp/repo-scans/scan-6/package-lock.json","/tmp/repo-scans/scan-6/package.json","/tmp/repo-scans/scan-6/pnpm-lock.yaml","/tmp/repo-scans/scan-6/src/app.ts","/tmp/repo-scans/scan-6/src/config/config.ts","/tmp/repo-scans/scan-6/src/config/dbConnect.ts","/tmp/repo-scans/scan-6/src/controllers/authController.ts","/tmp/repo-scans/scan-6/src/controllers/certificateController.ts","/tmp/repo-scans/scan-6/src/controllers/issuerController.ts","/tmp/repo-scans/scan-6/src/docs/.gitkeep","/tmp/repo-scans/scan-6/src/docs/swagger.ts","/tmp/repo-scans/scan-6/src/middlewares/authMiddleware.ts","/tmp/repo-scans/scan-6/src/middlewares/errorHandler.ts","/tmp/repo-scans/scan-6/src/middlewares/rateLimiter.ts","/tmp/repo-scans/scan-6/src/middlewares/roleMiddleware.ts","/tmp/repo-scans/scan-6/src/models/certificateModel.ts","/tmp/repo-scans/scan-6/src/models/issuerModel.ts","/tmp/repo-scans/scan-6/src/models/userModel.ts","/tmp/repo-scans/scan-6/src/routes/authRoutes.ts","/tmp/repo-scans/scan-6/src/routes/issuerRoutes.ts","/tmp/repo-scans/scan-6/src/routes/userRoutes.ts","/tmp/repo-scans/scan-6/src/seeders/seeder.ts","/tmp/repo-scans/scan-6/src/server.ts","/tmp/repo-scans/scan-6/src/services/authService.ts","/tmp/repo-scans/scan-6/src/types/authTypes.ts","/tmp/repo-scans/scan-6/src/types/xss-clean.d.ts","/tmp/repo-scans/scan-6/src/utils/emailService.ts","/tmp/repo-scans/scan-6/src/utils/jwt.ts","/tmp/repo-scans/scan-6/src/utils/logger.ts","/tmp/repo-scans/scan-6/src/validations/registerSchema.ts","/tmp/repo-scans/scan-6/tsconfig.json"]},"skipped_rules":[]}